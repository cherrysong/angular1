+function(a){!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(b){function j(c){var r,s,t,d=c||a.event,h=e.call(arguments,1),j=0,m=0,n=0,o=0,p=0,q=0;return c=b.event.fix(d),c.type="mousewheel","detail"in d&&(n=-1*d.detail),"wheelDelta"in d&&(n=d.wheelDelta),"wheelDeltaY"in d&&(n=d.wheelDeltaY),"wheelDeltaX"in d&&(m=-1*d.wheelDeltaX),"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(m=-1*n,n=0),j=0===n?m:n,"deltaY"in d&&(n=-1*d.deltaY,j=n),"deltaX"in d&&(m=d.deltaX,0===n&&(j=-1*m)),0!==n||0!==m?(1===d.deltaMode?(r=b.data(this,"mousewheel-line-height"),j*=r,n*=r,m*=r):2===d.deltaMode&&(s=b.data(this,"mousewheel-page-height"),j*=s,n*=s,m*=s),o=Math.max(Math.abs(n),Math.abs(m)),(!g||g>o)&&(g=o,l(d,o)&&(g/=40)),l(d,o)&&(j/=40,m/=40,n/=40),j=Math[j>=1?"floor":"ceil"](j/g),m=Math[m>=1?"floor":"ceil"](m/g),n=Math[n>=1?"floor":"ceil"](n/g),i.settings.normalizeOffset&&this.getBoundingClientRect&&(t=this.getBoundingClientRect(),p=c.clientX-t.left,q=c.clientY-t.top),c.deltaX=m,c.deltaY=n,c.deltaFactor=g,c.offsetX=p,c.offsetY=q,c.deltaMode=0,h.unshift(c,j,m,n),f&&clearTimeout(f),f=setTimeout(k,200),(b.event.dispatch||b.event.handle).apply(this,h)):void 0}function k(){g=null}function l(a,b){return i.settings.adjustOldDeltas&&"mousewheel"===a.type&&0===b%120}var f,g,h,i,c=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],d="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],e=Array.prototype.slice;if(b.event.fixHooks)for(h=c.length;h;)b.event.fixHooks[c[--h]]=b.event.mouseHooks;i=b.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=d.length;a;)this.addEventListener(d[--a],j,!1);else this.onmousewheel=j;b.data(this,"mousewheel-line-height",i.getLineHeight(this)),b.data(this,"mousewheel-page-height",i.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=d.length;a;)this.removeEventListener(d[--a],j,!1);else this.onmousewheel=null;b.removeData(this,"mousewheel-line-height"),b.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var c=b(a),d=c["offsetParent"in b.fn?"offsetParent":"parent"]();return d.length||(d=b("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(a){return b(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}},b.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})}(window,jQuery),+function(a,b){b.fn.addTree=function(c){var f,g,h,i,d={},e={showLog:!1,key:"mapId",parentKey:"pId",name:"xqmc",childKey:"children",data:[],cache:!1,cacheId:"wTreeLocalStorage",itemIdPrefix:"fd-tree-",operateItemClass:".tree-name",selectedIndex:0,selectedIsTriggerCallback:!1,goToTargetClass:"tree-hd-warning",selectedClass:"tree-hd-selected",disabledClass:"disabled",hoverClass:"tree-hd-hover",hideTrigerClass:"hide",collapseClass:"tree-hd-collapse",nodeNameClass:"tree-name",checkboxClass:"fd-checkbox",checkedClass:"fd-checked",treeContentClass:"ul-tree-ct",itemClass:"tree-item",itemHeadClass:"tree-hd",triggerClass:"fd-trigger",extendArea:!1,tweenTime:300,collapseChildren:!0,defaultCollapse:!0,defaultExpandIndex:0,hasAnimate:!0,hasCheckbox:!1,hasIcon:!0,type:2,lastItemClass:"tree-item-last",allowAppendNewNode:!0,canSelected:!0,hasHoverEffect:!0,onlyExpandOneLevel:!0,hasTips:!1,tipsTriggerElement:".tree-name",canSearch:!1,searchKey:["id","mapId"],searchName:["mc","xqmc","tsmc","rymc"],searchScrollTweenTime:400,searchInput:"#jsSearch",searchButton:"#jsBtnSearch",limitCount:5,deferTime:200,isAutocompleter:!0,hideAutocompleterClass:"hide",menuSelectedClass:"selected",autocompleterContain:"#jsAutocompleter",treeContain:"#jsTreeContain",autocompleterIsAjax:!1,autocompleterAjax:{url:"json/search.json",method:"get",data:"nr",dataType:"json",asych:!0,success:function(){console.log("成功")},error:function(){console.log("失败")}},hasScrollBar:!0,scrollBarContain:".fd-scroll-track",scrollBarClass:"fd-scroll-bar",pressClass:"pressed",scrollBarMinHeight:50,scrollStep:10,scrollTweenTime:10,callback:{appendNewNode:function(a,c,d,e){var f=a.data("mapid");b.ajax({url:"json/ry.json",dataType:"json",data:f,method:"get",cache:!1,crossDomain:!1,timeout:2e3,async:!1,success:function(b){var c=b.result.dataList,d=parseInt(a.attr("level"))+1,f=e.view.appendNodes(c,d,0,[{key:"tsid",name:"tsmc",childKey:"ryList",collapseChildren:!0,className:"tree-ts",allowAppendNewNode:!1,canSelected:!1,hasHoverEffect:!1,hasTips:!1},{key:"ryid",name:"rymc",childKey:"",collapseChildren:!0,className:"tree-ts",allowAppendNewNode:!1,canSelected:!1,hasHoverEffect:!1,hasTips:!1}]);a.siblings("."+e.opts.treeContentClass)[0].innerHTML=f}})},tips:function(){},onMouseenter:function(){},onMouseleave:function(){},onMmousemove:function(){},onNodeCreated:function(){console.log("节点被创建的事件")},onClick:function(){console.log("点击事件")},onDblClick:function(){console.log("双击事件")},onMouseDown:function(){console.log("鼠标按下事件")},onMouseUp:function(){console.log("鼠标按松开事件")},onExpand:function(a,b,c,d){console.log("展开的回调函数"),d.scrollBar.update(20)},onCollapse:function(a,b,c,d){console.log("收起的回调函数"),d.scrollBar.update(20)},onDestory:function(){console.log("销毁的回调函数")},checked:function(a,b,c){console.log("阻止冒泡"),console.log(c)},unchecked:function(a,b,c){console.log("阻止冒泡uncheck"),console.log(c)},search:function(a,c,d,e,f){var h,g=b("#"+e.opts.itemIdPrefix+a);g.size()<1?(h=b("#"+e.opts.itemIdPrefix+f.fyid),h.size()>0&&e.opts.allowAppendNewNode&&(e.opts.showLog&&console.log("不存在了，需要添加节点"),e.opts.callback.appendNewNode(h,c,d,e))):e.opts.showLog&&console.log("自己玩去吧，已经存在了")},selected:function(a,b){var e,c=d._this.find(d.opts.operateItemClass).eq(a);c.size()>0&&(e=d._this.find("."+d.opts.selectedClass),e.size()>0&&e.removeClass(d.opts.selectedClass),c.addClass(d.opts.selectedClass),b&&c.trigger("click.tree"))}}};return d.opts=b.extend(!0,{},e,c||{}),d._this=b(this),d.cacheId=d.opts.cacheId+d._this.attr("id"),f=a.navigator.appVersion.toUpperCase(),f.indexOf("MSIE")&&(g=f.indexOf("MSIE"),h=f.indexOf(";",g+4),i=parseInt(f.substring(g+4,h)),8>i&&(d.opts.tweenTime=10)),d.init=function(){return d.view.createTree(),d.bindEvent.normal(),d.defaultExpand(),d.opts.hasTips&&d.createTipsBox(),d},d.update=function(a){d.opts.data=a,d.view.createTree(),d.defaultExpand(),d.opts.hasScrollBar&&setTimeout(function(){d.scrollBar.update(20)},100)},d.defaultSelected=function(a,c){"number"===b.type(a)&&("boolean"===b.type(c)?d.opts.callback.selected(a,c):d.opts.callback.selected(a))},d.setWhatItemCanSelected=function(a,c){if("number"===b.type(a)){var e=!1;"boolean"===b.type(c)&&(e=c),e?d._this.find("."+d.opts.itemHeadClass).each(function(){var c=b(this),d=parseInt(c.attr("level")),e=c.attr("canselected");d>a?b(this).attr("canselected","false"):"false"!==e&&b(this).attr("canselected","true")}):d._this.find("."+d.opts.itemHeadClass).each(function(){var c=b(this),d=c.attr("level");d>a&&c.attr("canselected","false")})}},d.createTipsBox=function(){d.tipsBox=b("<div></div>").css({position:"absolute",top:"0",left:"0","white-space":"nowrap",font:'14px/1.4em "Microsoft YaHei"',"box-shadow":"0 0 4px 1px rgba(46, 139, 147, 0.5)",background:"rgba(9, 51, 101, 0.8)","z-index":"99",padding:"5px 10px",display:"none",color:"#fff","border-radius":"3px"}),d.tipsBox.appendTo("body")},d.data={transformTozTreeFormat:function(a){var c,e,i,j,f=d.opts.key,g=d.opts.parentKey,h=d.opts.childKey;return f&&""!=f&&a?b.isArray(a)?(i=[],j={},function(){for(var b=0,c=a.length;c>b;b++)j[a[b][f]]=a[b];b=null,c=null}(),function(){for(c=0,e=a.length;e>c;c++)j[a[c][g]]&&a[c][f]!=a[c][g]?(j[a[c][g]][h]||(j[a[c][g]][h]=[]),j[a[c][g]][h].push(a[c])):i.push(a[c])}(),i):[a]:[]}},d.view={createTree:function(){var b="";return d.opts.cache?a.localStorage.getItem(d.cacheId)?(b=a.localStorage.getItem(d.cacheId),d.opts.data=JSON.parse(a.localStorage.getItem(d.cacheId+"data"))):(d.opts.data=d.data.transformTozTreeFormat(d.opts.data),b=d.view.appendNodes(d.opts.data,1),a.localStorage.setItem(d.cacheId,b),a.localStorage.setItem(d.cacheId+"data",JSON.stringify(d.opts.data))):(d.opts.data=d.data.transformTozTreeFormat(d.opts.data),b=d.view.appendNodes(d.opts.data,1)),d._this[0].innerHTML=b,d},appendNodes:function(a,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(!a)return[];for(g=[],h=d.opts.key,i=d.opts.childKey,j=d.opts.allowAppendNewNode,k=d.opts.collapseChildren,l=d.opts.name,m=d.opts.canSelected,n=d.opts.hasHoverEffect,o="",p=d.opts.hasTips,"number"===b.type(e)&&"array"===b.type(f)&&(e=e,h=f[e].key?f[e].key:h,i=f[e].childKey?f[e].childKey:i,"undefined"!==f[e].allowAppendNewNode&&(j=f[e].allowAppendNewNode),l=f[e].name?f[e].name:l,"undefined"!==f[e].collapseChildren&&(k=f[e].collapseChildren),"undefined"!==f[e].canSelected&&(m=f[e].canSelected),"undefined"!==f[e].hasHoverEffect&&(n=f[e].hasHoverEffect),o=f[e].className?f[e].className+"-"+e:o,"undefined"!==f[e].hasTips&&(p=f[e].hasTips)),q=0,r=a.length;r>q;q++)s=a[q],t=[],u=!1,s[i]&&s[i].length>0&&(u=!0,t=d.view.appendNodes(s[i],c+1,e+1,f)),d.view.makeDOMNodeMainBefore(g,c,q,r),d.view.makeDOMNodeNameBefore(g,s,c,h,i,k,j,o,m,n,p),d.view.makeDOMNodeTrigger(g,u,j),d.view.makeDOMNodeABefore(g,s),d.view.makeDOMNodeIcon(g),d.view.makeDOMNodeCheckbox(g),d.view.makeDOMNodeAAfter(g,s,l),d.view.makeDOMNodeNameAfter(g),d.view.makeUlHtml(g,t,c,u,k,o),d.view.makeDOMNodeMainAfter(g);return g.join("")},makeDOMNodeMainBefore:function(a,b,c,e){var f=!1;2===d.opts.type?(c+1===e&&(f=!0),a.push('<li   class="'+d.opts.itemClass+" "+(f?d.opts.lastItemClass:"")+"  tree-item-0"+b+'"   >')):a.push('<li   class="'+d.opts.itemClass+"  tree-item-0"+b+'"   >')},makeDOMNodeNameBefore:function(a,b,c,e,f,g,h,i,j,k,l){var n,m=[];h=h,g=g,j=j,j=j,l=l;for(name in b)""===b[name]&&(b[name]="false"),name!==f&&m.push("data-"+name+"="+b[name]);n=d.opts.itemHeadClass+" "+(b.disabled?d.opts.disabledClass:"")+" tree-hd-0"+c,g&&(n=n+" "+d.opts.collapseClass),i&&(n=n+" "+i),a.push(' <h3 hastips="'+l+'" canselected="'+j+'"  hover="'+k+'"   allowAppendNewNode="'+h+'"  level="'+c+'"    '+m.join(" ")+'  id="'+d.opts.itemIdPrefix+b[e]+'"  class="'+n+'"> ')},makeDOMNodeTrigger:function(a,b,c){var e=d.opts.triggerClass;b||c||(e=d.opts.triggerClass+" "+d.opts.hideTrigerClass),a.push(' <span class="'+e+'"></span>')},makeDOMNodeABefore:function(a,b){b.url?a.push(' <a href="'+b.url+'" hidefocus="true"  class="'+d.opts.nodeNameClass+'"  >'):a.push(' <a href="javascript:void(0);" hidefocus="true"  class="'+d.opts.nodeNameClass+'"  >')},makeDOMNodeIcon:function(a){d.opts.hasIcon&&a.push('<span class="fd-icon"  title="图标容器">图标</span>')},makeDOMNodeCheckbox:function(a){d.opts.hasCheckbox&&a.push(' <span class="'+d.opts.checkboxClass+'"><input type="checkbox" name=""   /></span>')},makeDOMNodeAAfter:function(a,b,c){a.push(b[c]+"</a>")},makeDOMNodeNameAfter:function(a){a.push("</h3>")},makeUlHtml:function(a,b,c,e,f,g){var i,h="";f&&(h="style=display:none;"),i=d.opts.treeContentClass+" ul-tree-ct-0"+c,g&&(i=i+" "+g),e?a.push(" <ul "+h+'  class="'+i+' ">'+b+"</ul>"):a.push(" <ul "+h+'   class="'+i+'"></ul>')},makeDOMNodeMainAfter:function(a){a.push("</li>")}},d.destory=function(){d.unbindEvent.allEvent(),d.html("")},d.animate=function(a,c,d,e,f,g,h){return d.is(":animated")?!1:(h.opts.hasAnimate||(h.opts.tweenTime=0),a?(c.removeClass(h.opts.collapseClass),h.opts.onlyExpandOneLevel&&d.parent().siblings().each(function(){var a=b(this),c=a.children("."+h.opts.itemHeadClass),d=c.hasClass(h.opts.collapseClass);d||c.addClass(h.opts.collapseClass).next("."+h.opts.treeContentClass).slideUp(h.opts.tweenTime)}),d.stop(!0,!0).slideDown(h.opts.tweenTime,function(){"function"===b.type(h.opts.callback.onExpand)&&h.opts.callback.onExpand(e,f,g,h)})):(c.addClass(h.opts.collapseClass),d.stop(!0,!0).slideUp(h.opts.tweenTime/h.opts.tweenTime,function(){"function"===b.type(h.opts.callback.onCollapse)&&h.opts.callback.onCollapse(e,f,g,h)})),void 0)},d.bindEvent={getTarget:function(c){var d;return c=c||a.event,d=b(c.target)},stopBubble:function(a){a.stopPropagation()},normal:function(){d.bindEvent.mouseenter(),d.bindEvent.mouseleave(),d.bindEvent.click(),d.bindEvent.toggleChecked(),d.bindEvent.toggleSlide(),d.opts.hasTips&&(d.bindEvent.mouseenter(),d.bindEvent.mouseleave(),d.bindEvent.mousemove())},all:function(){d.bindEvent.mouseenter(),d.bindEvent.mouseleave(),d.bindEvent.mousemove(),d.bindEvent.click(),d.bindEvent.dblclick(),d.bindEvent.mouseDown(),d.bindEvent.mouseUp(),d.bindEvent.toggleChecked(),d.bindEvent.toggleSlide()},mouseenter:function(){d._this.off("mouseenter.tree").on("mouseenter.tree","."+d.opts.itemHeadClass,function(c){var f,g,h,e=b(this);c=c||a.event,f=d.bindEvent.getTarget(c),"true"===e.attr("hover")&&(e.addClass(d.opts.hoverClass),"function"===b.type(d.opts.callback.onMouseenter)&&d.opts.callback.onMouseenter(e,c,f,d)),"true"===e.attr("hastips")&&f.is(d.opts.tipsTriggerElement)&&(g=c.pageY,h=c.pageX,d.tipsBox.text(e.find("a").text().substr(2)).css({top:g,left:h+20,display:"block"}),"function"===b.type(d.opts.callback.tips)&&d.opts.callback.tips(e,c,f,d))})},mouseleave:function(){d._this.off("mouseleave.tree").on("mouseleave.tree","."+d.opts.itemHeadClass,function(a){var e,c=b(this);c.hasClass(d.opts.hoverClass)&&c.removeClass(d.opts.hoverClass),"true"===c.attr("hastips")&&d.tipsBox.is(":visible")&&d.tipsBox.css({display:"none"}),e=d.bindEvent.getTarget(a),"function"===b.type(d.opts.callback.onMouseleave)&&d.opts.callback.onMouseleave(c,a,e,d)})},mousemove:function(){d._this.off("mousemove.tree").on("mousemove.tree","."+d.opts.itemHeadClass,function(c){var g,h,e=b(this),f=d.bindEvent.getTarget(c);c=c||a.event,"true"===e.attr("hastips")&&(g=c.pageY,h=c.pageX,f.is(d.opts.tipsTriggerElement)?(d.tipsBox.is(":hidden")&&d.tipsBox.css({display:"block"}),d.tipsBox.css({top:g,left:h+20})):d.tipsBox.is(":visible")&&d.tipsBox.css({display:"none"})),"function"===b.type(d.opts.callback.onMouseleave)&&d.opts.callback.onMmousemove(e,c,f,d)})},click:function(){d._this.off("click.tree").on("click.tree",d.opts.operateItemClass,function(a){var h,c=b(this),e=c.closest("."+d.opts.itemHeadClass),f=d.bindEvent.getTarget(a),g=f.is("."+d.opts.triggerClass);return g&&!d.opts.extendArea?(d.opts.showLog&&console.log("_scope.opts.extendArea为false,点击fd-trigger元素阻止默认事件"),void 0):(h=d._this.find("."+d.opts.goToTargetClass),h.size()>0&&h.removeClass(d.opts.goToTargetClass),"true"===e.attr("canselected")&&(e.hasClass(d.opts.selectedClass)?d.opts.showLog&&console.log("点击"+d.opts.operateItemClass+",该条数据已经是选中状态，无需执行click函数；"):(d._this.find("."+d.opts.selectedClass).removeClass(d.opts.selectedClass),e.addClass(d.opts.selectedClass),"function"===b.type(d.opts.callback.onClick)&&d.opts.callback.onClick(c,a,f,d),d.opts.showLog&&console.log("点击"+d.opts.operateItemClass+",该条数据增加选中状态，执行click函数；"))),void 0)})},dblclick:function(){d._this.off("dblclick.tree").on("dblclick.tree",d.opts.operateItemClass,function(a){var c=b(this),e=d.bindEvent.getTarget(a);"function"===b.type(d.opts.callback.onDblClick)&&d.opts.callback.onDblClick(c,a,e,d)})},mouseDown:function(){d._this.off("mousedown.tree").on("mousedown.tree",d.opts.operateItemClass,function(a){var c=b(this),e=d.bindEvent.getTarget(a);"function"===b.type(d.opts.callback.onMouseDown)&&d.opts.callback.onMouseDown(c,a,e,d)})},mouseUp:function(){d._this.off("mouseup.tree").on("mouseup.tree",d.opts.operateItemClass,function(a){var c=b(this),e=d.bindEvent.getTarget(a);"function"===b.type(d.opts.callback.onMouseUp)&&d.opts.callback.onMouseUp(c,a,e,d)})},toggleChecked:function(){d.opts.hasCheckbox&&d._this.off("click.toggleChecked").on("click.toggleChecked","."+d.opts.checkboxClass,function(a){var c=b(this),e=d.bindEvent.getTarget(a),f=e.closest("."+d.opts.checkboxClass);return d.bindEvent.stopBubble(a),f.closest("."+d.opts.itemHeadClass).hasClass(d.opts.disabledClass)?(a.preventDefault(),void 0):(f.hasClass(d.opts.checkedClass)?(f.removeClass(d.opts.checkedClass),"function"===b.type(d.opts.callback.unchecked)&&(d.opts.callback.unchecked(c,a,e,d),d.opts.showLog&&console.log("点击"+d.opts.checkboxClass+",有选中类名"+d.opts.checkedClass+"取消选中，那么执行unchecked函数；"))):(f.addClass(d.opts.checkedClass),"function"===b.type(d.opts.callback.checked)&&(d.opts.callback.checked(c,a,e,d),d.opts.showLog&&console.log("点击"+d.opts.checkboxClass+",没有选中类名"+d.opts.checkedClass+"选中checkbox，那么执行checked函数；"))),void 0)})},toggleSlide:function(){d._this.off("click.toggleSlide").on("click.toggleSlide","."+d.opts.itemHeadClass,function(a){var c=b(this),e=d.bindEvent.getTarget(a),f=e.closest("."+d.opts.itemHeadClass),g=f.hasClass(d.opts.collapseClass),h=f.next("."+d.opts.treeContentClass),i=""===b.trim(h.text())?!0:!1;if(!f.hasClass(d.opts.disabledClass)){if(i){if(!d.opts.allowAppendNewNode)return d.opts.showLog&&console.log("click.toggleSlide事件，没有子元素直接返回！"),void 0;d.opts.extendArea?"function"===b.type(d.opts.callback.appendNewNode)&&(console.log("extend"),d.opts.callback.appendNewNode(c,a,e,d)):e.is("."+d.opts.triggerClass)&&"function"===b.type(d.opts.callback.appendNewNode)&&d.opts.callback.appendNewNode(c,a,e,d)}d.opts.extendArea?(d.animate(g,f,h,c,a,e,d),d.opts.showLog&&console.log("click.toggleSlide事件，有子元素，是扩大区域，点击整条都能执行动画有效")):e.is("."+d.opts.triggerClass)&&(d.animate(g,f,h,c,a,e,d),d.opts.showLog&&console.log("click.toggleSlide事件，有子元素，不是扩大区域，点击trigger元素才能执行动画"))}})}},d.unbindEvent={mouseenter:function(){d._this.off("mouseenter.tree")},mouseleave:function(){d._this.off("mouseleave.tree")},click:function(){d._this.off("click.tree")},dblclick:function(){d._this.off("dblclick.tree")},mouseDown:function(){d._this.off("mouseDown.tree")},mouseUp:function(){d._this.off("mouseUp.tree")},toggleChecked:function(){d._this.off("click.toggleChecked")},toggleSlide:function(){d._this.off("click.toggleSlide")},all:function(){d.unbindEvent.mouseenter(),d.unbindEvent.mouseleave(),d.unbindEvent.click(),d.unbindEvent.dblclick(),d.unbindEvent.mouseDown(),d.unbindEvent.mouseUp(),d.unbindEvent.toggleChecked(),d.unbindEvent.toggleSlide()},normal:function(){d.unbindEvent.mouseenter(),d.unbindEvent.mouseleave(),d.unbindEvent.click(),d.unbindEvent.toggleChecked(),d.unbindEvent.toggleSlide()}},d.defaultExpand=function(){"number"==typeof d.opts.defaultExpandIndex&&d._this.children().eq(d.opts.defaultExpandIndex).children("."+d.opts.itemHeadClass).removeClass(d.opts.collapseClass).next("."+d.opts.treeContentClass).css("display","block")},d.search={searchButton:b(d.opts.searchButton),searchInput:b(d.opts.searchInput),treeContain:b(d.opts.treeContain),autocompleterContain:b(d.opts.autocompleterContain),goToTarget:function(a){var e,c=b("#"+d.opts.itemIdPrefix+a);d._this.find("."+d.opts.goToTargetClass).removeClass(d.opts.goToTargetClass),c.addClass(d.opts.goToTargetClass),c.parents("."+d.opts.treeContentClass).each(function(){var a=b(this),c=a.siblings("."+d.opts.itemHeadClass);c.hasClass(d.opts.collapseClass)&&c.removeClass(d.opts.collapseClass),a.is(":hidden")&&a.show()}),e=c.position().top,d.opts.hasScrollBar?d.scrollBar.update(d.opts.searchScrollTweenTime,e):d.search.treeContain.stop(!0,!0).animate({scrollTop:e},d.opts.searchScrollTweenTime)},callback:{search:function(a,c){var g,h,i,j,e=d.search.searchInput.data(),f="";for(g=0,h=d.opts.searchKey.length;h>g;g++)if(e[d.opts.searchKey[g]]){console.log("走了这里1"+f),f=e[d.opts.searchKey[g]];break}"function"===b.type(d.opts.callback.search)&&""!==f&&d.opts.callback.search(f,a,c,d,e),f?(d.search.goToTarget(f),d.search.searchInput.trigger("blur.autocompleter")):(i=b.trim(d.search.searchInput.val()),""!==i?(j=!0,b.each(d.autocompleter.response,function(g,h){var l,m,k="";for(l=0,m=d.opts.searchName.length;m>l;l++)if(h[d.opts.searchName[l]]){k=d.opts.searchName[l];break}if(h[k]===i){for(d.search.searchInput.data(h),j=!1,e=h,l=0,m=d.opts.searchKey.length;m>l;l++)if(e[d.opts.searchKey[l]]){f=e[d.opts.searchKey[l]];break}return"function"===b.type(d.opts.callback.search)&&d.opts.callback.search(f,a,c,d,e),d.search.goToTarget(f),d.search.searchInput.trigger("blur.autocompleter"),!1}}),j&&d.search.searchInput.focus()):d.search.searchInput.focus())}}},d.autocompleter={timer:null,response:[],copyValueToSearch:function(a){var b,c,e,f,g;if(b=a?a:d.search.autocompleterContain.find("."+d.opts.menuSelectedClass),b.size()>0){for(c=b.data(),d.search.searchInput.removeData(),d.search.searchInput.data(c),e="",f=0,g=d.opts.searchName.length;g>f;f++)if(c[d.opts.searchName[f]]){e=c[d.opts.searchName[f]];break}d.search.searchInput.val(e),d.autocompleter.hideAutocompleter()}},hideAutocompleter:function(){b(d.search.autocompleterContain).addClass(d.opts.hideAutocompleterClass)},showAutocompleter:function(){b(d.search.autocompleterContain).removeClass(d.opts.hideAutocompleterClass)},query:function(a,c,e,f){var g,h,i;if(f)d.opts.showLog&&(console.log("发送到后台的数据是："),console.log({param:JSON.parse('{"'+d.opts.autocompleterAjax.data+'":"'+a+'"}')}),console.log("\n")),b.ajax({url:d.opts.autocompleterAjax.url,method:d.opts.autocompleterAjax.method,dataType:d.opts.autocompleterAjax.dataType,data:{param:'{"'+d.opts.autocompleterAjax.data+'":"'+a+'"}'},success:function(c,f,g){d.opts.showLog&&(console.log("后台返回的数据是："),console.log(c),console.log("\n")),"array"===b.type(c.result)?c.result.length>0&&(d.autocompleter.response=c.result,c.result.length>e&&(d.autocompleter.response=d.autocompleter.response.slice(0,e))):d.autocompleter.response=[],d.autocompleter.makeList(a),"function"===b.type(d.opts.autocompleterAjax.success)&&d.opts.autocompleterAjax.success(c,f,g,d)},error:function(a,c,e){"function"===b.type(d.opts.autocompleterAjax.error)&&d.opts.autocompleterAjax.error(a,c,e,d)}});else{if(c=c,e=e,d.autocompleter.response.length>=e)return!1;for(g=0,h=c.length;h>g&&(i=c[g],-1!==i[d.opts.name].search(a)&&d.autocompleter.response.push(i),i[d.opts.childKey]&&i[d.opts.childKey].length>0&&d.autocompleter.query(a,i[d.opts.childKey],e),!(d.autocompleter.response.length>=e));g++);}},makeList:function(a){var c,e,f,g,h,i,j,k,b=d.autocompleter.response.length;if(b>0){for(c=['<ul class="fd-search-menu">'],e=0;b>e;e++){f=d.autocompleter.response[e],g=[];for(k in f)k!==d.opts.childKey&&(""===f[k]&&(f[k]="false"),g.push("data-"+k+"="+f[k]));for(g=g.join(" "),h="",i=0,j=d.opts.searchName.length;j>i;i++)if(f[d.opts.searchName[i]]){h=d.opts.searchName[i];break}k=f[h].split(a).join("<em>"+a+"</em>"),c.push('<li  class="fd-item" '+g+">"+k+"</li>")}c.push("</ul>"),d.search.autocompleterContain[0].innerHTML=c.join(""),d.search.autocompleterContain.removeClass(d.opts.hideAutocompleterClass),d.opts.isAutocompleter||d.search.autocompleterContain.addClass(d.opts.hideAutocompleterClass)}else d.search.autocompleterContain.html('<div class="fd-empty-contain">未找到符合条件的数据</div>').removeClass(d.opts.hideAutocompleterClass),d.search.searchInput.removeData(),d.opts.isAutocompleter||d.search.autocompleterContain.addClass(d.opts.hideAutocompleterClass)},ignoredKeyCod:[9,13,17,19,20,27,33,34,35,36,37,39,44,92,113,114,115,118,119,120,122,123,144,145],bindEvent:function(){d.search.searchInput.off("keydown.autocompleter").on("keydown.autocompleter",d.autocompleter.keydown),d.search.searchInput.off("keyup.autocompleter").on("keyup.autocompleter",d.autocompleter.keyup),d.search.searchInput.off("focus.autocompleter").on("focus.autocompleter",d.autocompleter.focus),d.search.searchInput.off("blur.autocompleter").on("blur.autocompleter",d.autocompleter.blur),d.search.autocompleterContain.off("mousedown.autocompleter").on("mousedown.autocompleter","li",d.autocompleter.mousedown)},keydown:function(a){var b=a.keyCode?a.keyCode:a.which;a.data,40===b||38===b?(a.preventDefault(),a.stopPropagation()):39===b||13===b&&(a.preventDefault(),a.stopPropagation())},search:function(){var a=b.trim(d.search.searchInput.val());""!==a?(d.autocompleter.response=[],d.opts.autocompleterIsAjax?d.autocompleter.query(a,d.opts.data,d.opts.limitCount,!0):(d.autocompleter.query(a,d.opts.data,d.opts.limitCount),d.autocompleter.makeList(a))):b(d.search.autocompleterContain).hasClass(d.opts.hideAutocompleterClass)||d.autocompleter.hideAutocompleter()},focus:function(){d.autocompleter.search()},blur:function(){d.autocompleter.hideAutocompleter(),d.search.searchInput.removeData()},keyup:function(a){var e,f,g;if(a.data,e=a.keyCode?a.keyCode:a.which,40===e||38===e){if(b(d.search.autocompleterContain).hasClass(d.opts.hideAutocompleterClass)||b(d.search.autocompleterContain).find("ul").size()<1)return;f=-1,g=d.search.autocompleterContain.find("."+d.opts.menuSelectedClass),g.size()>0&&(f=g.index()),40==e?(f++,f>=d.autocompleter.response.length&&(f=0)):38==e&&(f--,0>f&&(f=d.autocompleter.response.length-1)),d.search.autocompleterContain.find("ul").children().removeClass(d.opts.menuSelectedClass).eq(f).addClass(d.opts.menuSelectedClass)}else-1===b.inArray(e,d.autocompleter.ignoredKeyCod)?(d.autocompleter.timer&&(clearTimeout(d.autocompleter.timer),d.autocompleter.timer=null),d.autocompleter.timer=setTimeout(function(){d.autocompleter.search()},d.opts.deferTime)):(13===e&&(d.search.autocompleterContain.hasClass(d.opts.hideAutocompleterClass)?d.search.searchButton.trigger("click.search"):(d.autocompleter.copyValueToSearch(),d.search.searchButton.trigger("click.search"))),d.opts.showLog&&console.log("禁用键"+e))},mousedown:function(){d.autocompleter.copyValueToSearch(b(this)),d.search.searchButton.trigger("click.search")}},d.scrollBar={range:function(a,b,c){return Math.ceil(Math.min(b,Math.max(a,c)))},stopBubble:function(a){a.stopPropagation(),a.preventDefault()},createScrollBar:function(){d.scrollBar.trackContain.html('<span class="'+d.opts.scrollBarClass+'"></span>'),d.scrollBar.bar=d.scrollBar.trackContain.find("."+d.opts.scrollBarClass)},getParamHeight:function(){d.scrollBar.offsetHeight=d.scrollBar.parentContain.height(),d.scrollBar.scrollHeight=d.scrollBar.contentContain.innerHeight(),d.scrollBar.trackContainHeight=d.scrollBar.trackContain.innerHeight();var a=d.scrollBar.offsetHeight/d.scrollBar.scrollHeight*d.scrollBar.trackContainHeight;d.scrollBar.barHeight=Math.max(d.opts.scrollBarMinHeight,a),d.scrollBar.scrollMinDistance=0,d.scrollBar.scrollMaxDistance=d.scrollBar.trackContainHeight-d.scrollBar.barHeight,d.scrollBar.scrollAreaHeight=d.scrollBar.trackContainHeight-d.scrollBar.barHeight,d.scrollBar.bar.height(d.scrollBar.barHeight),d.scrollBar.offsetHeight>d.scrollBar.scrollHeight?d.scrollBar.trackContain.hide():d.scrollBar.trackContain.show()},update:function(a,c){var e,f,g,h,i;if("number"==b.type(c))c=c,d.scrollBar.getParamHeight(),d.scrollBar.scrollHeight-c<d.scrollBar.offsetHeight&&(c=d.scrollBar.scrollHeight-d.scrollBar.offsetHeight),e=Math.abs(c)/(d.scrollBar.scrollHeight-d.scrollBar.offsetHeight);else{if(d.scrollBar.scrollHeight===d.scrollBar.contentContain.innerHeight()&&d.scrollBar.offsetHeight===d.scrollBar.parentContain.height())return;f=parseInt(d.scrollBar.contentContain.css("top"))?parseInt(d.scrollBar.contentContain.css("top")):0,e=Math.abs(f)/(d.scrollBar.scrollHeight-d.scrollBar.offsetHeight),g=d.scrollBar.scrollHeight,d.scrollBar.getParamHeight(),h=Math.abs(f)/(d.scrollBar.scrollHeight-d.scrollBar.offsetHeight),i=d.scrollBar.scrollHeight,e=i>g?Math.min(h,e):Math.max(h,e),e>1&&(e=1)}d.scrollBar.bar.stop(!0,!0).animate({top:d.scrollBar.scrollAreaHeight*e},a),d.scrollBar.contentContain.stop(!0,!0).animate({top:-Math.round((d.scrollBar.scrollHeight-d.scrollBar.offsetHeight)*e)},a)},moveFunction:function(a){var c,e,b=""==parseInt(d.scrollBar.bar.css("top"))?0:parseInt(d.scrollBar.bar.css("top"));b+=Number(a),c=d.scrollBar.range(b,d.scrollBar.scrollMaxDistance,d.scrollBar.scrollMinDistance),e=c/d.scrollBar.scrollAreaHeight,d.scrollBar.bar.stop(!0,!0).animate({top:c},d.opts.scrollTweenTime),d.scrollBar.contentContain.stop(!0,!0).animate({top:-(d.scrollBar.scrollHeight-d.scrollBar.offsetHeight)*e},d.opts.scrollTweenTime)},mousewheel:function(a){d.scrollBar.stopBubble(a);var b=a.deltaY,c=0;switch(b){case 1:c=-1*d.opts.scrollStep,d.scrollBar.moveFunction(c);break;case-1:c=d.opts.scrollStep,d.scrollBar.moveFunction(c)}},mousedown:function(c){var e=b(this),f=c.pageY,g=0,h=0;e.addClass(d.opts.pressClass),b(a).on("mousemove.scrollBar",function(a){d.scrollBar.stopBubble(a),h=a.pageY,g=h-f,f=h,d.scrollBar.moveFunction(g)}).on("mouseup.scrollBar",function(){b(a).off("mousemove.scrollBar"),b(a).off("mouseup.scrollBar"),e.removeClass(d.opts.pressClass)})},resize:function(){d.scrollBar.update(20)},bindEvent:function(){d.scrollBar.parentContain.on("mousewheel.scrollBar",d.scrollBar.mousewheel),d.scrollBar.parentContain.on("mousedown.scrollBar","."+d.opts.scrollBarClass,d.scrollBar.mousedown),b(a).on("resize.scrollBar",d.scrollBar.resize)},unbindEvent:function(){d.scrollBar.parentContain.off("mousewheel.scrollBar",d.scrollBar.mousewheel),d.scrollBar.parentContain.off("mousedown.scrollBar","."+d.opts.scrollBarClass,d.scrollBar.mousedown),b(a).off("resize.scrollBar")},init:function(){d.scrollBar.parentContain=b(d.opts.treeContain),d.scrollBar.parentContain.css({overflow:"hidden"}),d.scrollBar.trackContain=d.scrollBar.parentContain.children(d.opts.scrollBarContain),d.scrollBar.contentContain=d._this,d.scrollBar.createScrollBar(),d.scrollBar.getParamHeight(),d.scrollBar.bindEvent()},destory:function(){d.scrollBar.unbindEvent(),d.scrollBar.trackContain.html("")}},d.init(),d.opts.canSearch&&(d.autocompleter.bindEvent(),d.search.searchButton.off("click.search").on("click.search",function(c){var e;c=c||a.event,e=b(c.target),d.search.callback.search(c,e)})),d.opts.hasScrollBar&&d.scrollBar.init(),d}}(window,jQuery);